{
  "name": "Move Scan Suite",
  "tests": [
    {
      "name": "Setup: mover_scan",
      "setup": "macro_auth_user",
      "username": "mover_scan",
      "password": "password"
    },
    {
      "name": "Rig: Position mover_scan player at Sector 1",
      "command": "sys.raw_sql_exec",
      "user": "admin",
      "data": {
        "sql": "UPDATE players SET sector_id = 1 WHERE name = 'mover_scan';"
      },
      "expect": { "status": "ok" }
    },
    {
      "name": "Rig: Position mover_scan ship at Sector 1",
      "command": "sys.raw_sql_exec",
      "user": "admin",
      "data": {
        "sql": "UPDATE ships SET sector_id = 1 WHERE ship_id = (SELECT ship_id FROM players WHERE name = 'mover_scan');"
      },
      "expect": { "status": "ok" }
    },
    {
      "name": "Rig: Position mover_scan player at Sector 1",
      "command": "sys.raw_sql_exec",
      "user": "admin",
      "data": {
        "sql": "UPDATE players SET sector_id = 1 WHERE name = 'mover_scan';"
      },
      "expect": { "status": "ok" }
    },
    {
      "name": "Rig: Position mover_scan ship at Sector 1",
      "command": "sys.raw_sql_exec",
      "user": "admin",
      "data": {
        "sql": "UPDATE ships SET sector_id = 1 WHERE ship_id = (SELECT ship_id FROM players WHERE name = 'mover_scan');"
      },
      "expect": { "status": "ok" }
    },
    {
      "name": "Positive: Move Scan",
      "command": "move.scan",
      "user": "mover_scan",
      "expect": { "status": "ok" },
      "asserts": [
        { "path": "data.sector_id", "op": "==", "value": 1 }
      ]
    },
    {
      "name": "Negative: Move Scan Missing Auth",
      "command": "move.scan",
      "expect": { "status": "error", "error_code": 401 }
    }
  ]
}
