{
  "test_suite_name": "Ship Reregister Command",
  "description": "Tests the ship.reregister command (which reuses ship.rename handler)",
  "tests": [
    {
      "name": "Setup: User and Ship",
      "setup": "macro_auth_user",
      "username": "rereg_user",
      "password": "password"
    },
    {
      "name": "Get User's Ship ID",
      "command": "player.my_info",
      "user": "rereg_user",
      "expect": { "status": "ok" },
      "extract": {
        "ship_id": "data.player.ship_id"
      }
    },
    {
      "name": "Test ship.reregister command with new name",
      "user": "rereg_user",
      "command": "ship.reregister",
      "data": { "ship_id": "${ship_id}", "new_name": "New Awesome Name" },
      "expect": { "status": "ok", "type": "ship.renamed" },
      "asserts": [
        { "path": "data.ship_id", "op": "==", "value": "${ship_id}" },
        { "path": "data.name", "op": "==", "value": "New Awesome Name" }
      ]
    },
    {
      "name": "Verify new ship name",
      "user": "rereg_user",
      "command": "player.my_info",
      "expect": { "status": "ok" },
      "asserts": [
        { "path": "data.player.ship.name", "op": "==", "value": "New Awesome Name" }
      ]
    },
    {
      "name": "Test ship.reregister with empty name (should refuse)",
      "user": "rereg_user",
      "command": "ship.reregister",
      "data": { "ship_id": "${ship_id}", "new_name": "" },
      "expect": { "status": "refused", "error_code": 1300 }
    }
  ]
}
