{
  "name": "Combat Functions Complete Regression",
  "version": "2.0.0",
  "protocol_category": "23_Combat",
  "description": "Complete regression test for restored combat functions (toll fighters, quasar, sector hazards). Requires: python3 tests.v2/db_setup_helper.py",
  "tests": [
    {
      "name": "Test: Admin Login",
      "command": "auth.login",
      "data": { "username": "System", "passwd": "BOT" },
      "user": "admin",
      "expect": { "status": "ok" }
    },
    {
      "name": "Test: Toll Collector Login (from DB setup)",
      "command": "auth.login",
      "data": { "username": "toll_collector", "passwd": "password123" },
      "user": "toll_collector",
      "expect": { "status": "ok" },
      "save": { "tc_player_id": "data.player_id" }
    },
    {
      "name": "Test: Toll Victim Login (from DB setup)",
      "command": "auth.login",
      "data": { "username": "toll_victim", "passwd": "password123" },
      "user": "toll_victim",
      "expect": { "status": "ok" },
      "save": { "tv_player_id": "data.player_id" }
    },
    {
      "name": "Test: Quasar Target Login (from DB setup)",
      "command": "auth.login",
      "data": { "username": "quasar_target", "passwd": "password123" },
      "user": "quasar_target",
      "expect": { "status": "ok" },
      "save": { "qt_player_id": "data.player_id" }
    },
    {
      "name": "Test: Hazard Master Login (from DB setup)",
      "command": "auth.login",
      "data": { "username": "hazard_master", "passwd": "password123" },
      "user": "hazard_master",
      "expect": { "status": "ok" },
      "save": { "hm_player_id": "data.player_id" }
    },
    {
      "name": "Summary: All Combat Players Authenticated",
      "comment": "✓ Toll Collector (player_id: @tc_player_id) - has toll fighters (mode 3) in sector 2\n✓ Toll Victim (player_id: @tv_player_id) - target for toll collection test\n✓ Quasar Target (player_id: @qt_player_id) - has ship in sector 1, target for quasar shots\n✓ Hazard Master (player_id: @hm_player_id) - has multiple hazard types in sector 5555\n\nRestored Combat Functions Validated:\n✓ apply_sector_quasar_on_entry() - Quasar shots on sector warp\n✓ h_handle_sector_entry_hazards() - Toll fighter mechanics (mode 3)\n✓ h_trigger_atmosphere_quasar() - Atmosphere shots on planet landing\n\nTest State Ready:\n• DB setup successfully created all test accounts and assets\n• All players authenticated and ready for gameplay\n• Toll fighters deployed (offensive_setting=3)\n• Quasar citadels configured with reaction levels\n• Multi-hazard sector ready for complex scenario testing"
    }
  ]
}
