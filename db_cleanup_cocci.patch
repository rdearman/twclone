diff -u -p a/server_corporation.c b/server_corporation.c
--- a/server_corporation.c
+++ b/server_corporation.c
@@ -2636,6 +2636,7 @@ h_corp_is_publicly_traded (db_t *db, int
   db_bind_t params[] = { db_bind_i32 (corp_id) };
   db_res_t *res = NULL;
   db_error_t err;
+  int rc = 0;
 
 
   *is_publicly_traded = false;
@@ -2646,10 +2647,15 @@ h_corp_is_publicly_traded (db_t *db, int
         {
           *is_publicly_traded = true;
         }
-      db_res_finalize (res);
-      return 0;
+      rc = 0;
+      goto cleanup;
     }
-  return err.code;
+  rc = err.code;
+
+cleanup:
+  if (res)
+      db_res_finalize(res);
+  return rc;
 }
 
 
diff -u -p a/engine_consumer.c b/engine_consumer.c
--- a/engine_consumer.c
+++ b/engine_consumer.c
@@ -65,6 +65,7 @@ load_watermark (db_t *db, const char *ke
     "SELECT last_event_id, last_event_ts FROM engine_offset WHERE key=$1;";
   db_res_t *res = NULL;
   db_error_t err;
+  int rc = 0;
   db_bind_t params[] = { db_bind_text (key) };
 
   if (db_query (db, sql, params, 1, &res, &err))
@@ -79,10 +80,15 @@ load_watermark (db_t *db, const char *ke
           *last_id = 0;
           *last_ts = 0;
         }
-      db_res_finalize (res);
-      return 0;
+      rc = 0;
+      goto cleanup;
     }
-  return err.code;
+  rc = err.code;
+
+cleanup:
+  if (res)
+      db_res_finalize(res);
+  return rc;
 }
 
 
@@ -114,6 +120,7 @@ fetch_max_event_id (db_t *db, long long
     "SELECT COALESCE(MAX(engine_events_id),0) FROM engine_events;";
   db_res_t *res = NULL;
   db_error_t err;
+  int rc = 0;
 
   if (db_query (db, sql, NULL, 0, &res, &err))
     {
@@ -121,10 +128,15 @@ fetch_max_event_id (db_t *db, long long
         {
           *max_id = db_res_col_i64 (res, 0, &err);
         }
-      db_res_finalize (res);
-      return 0;
+      rc = 0;
+      goto cleanup;
     }
-  return err.code;
+  rc = err.code;
+
+cleanup:
+  if (res)
+      db_res_finalize(res);
+  return rc;
 }
 
 
