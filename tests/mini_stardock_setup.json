{
  "mini_stardock_setup": [
    {
      "name": "Register Admin",
      "command": "auth.register",
      "data": { "username": "admin", "passwd": "password" },
      "register_if_missing": true,
      "expect": { "status": "ok" }
    },
    {
      "name": "Login Admin",
      "command": "auth.login",
      "data": { "username": "admin", "passwd": "password" },
      "expect": { "status": "ok" },
      "user": "admin"
    },
    {
      "comment": "Create player at Stardock",
      "command": "sys.raw_sql_exec",
      "data": {
        "sql": "INSERT OR IGNORE INTO players (id, name, passwd, sector, ship, credits) VALUES (90001, 'test_player_stardock', 'test', (SELECT sector_id FROM stardock_location LIMIT 1), (SELECT id FROM ships LIMIT 1), 1000000);"
      },
      "user": "admin",
      "expect": {"status": "ok"}
    },
    {
      "comment": "Ensure player has a ship and assign it",
      "command": "sys.raw_sql_exec",
      "data": {
        "sql": "UPDATE players SET ship = (SELECT id FROM ships LIMIT 1) WHERE id = 90001;"
      },
      "user": "admin",
      "expect": {"status": "ok"}
    },
    {
      "comment": "Ensure player has a default ship type in shiptypes",
      "command": "sys.raw_sql_exec",
      "data": {
        "sql": "INSERT OR IGNORE INTO shiptypes (id, name, basecost, maxholds, maxfighters, maxshields, maxgenesis, max_detonators, max_probes, can_transwarp, can_planet_scan, can_long_range_scan, max_cloaks) VALUES (1, 'Test Freighter', 1000, 100, 1000, 500, 5, 5, 5, 1, 1, 1, 1);"
      },
      "user": "admin",
      "expect": {"status": "ok"}
    },
    {
      "comment": "Ensure player's ship is of a type that can carry hardware",
      "command": "sys.raw_sql_exec",
      "data": {
        "sql": "UPDATE ships SET type_id = 1 WHERE id = (SELECT ship FROM players WHERE id = 90001);"
      },
      "user": "admin",
      "expect": {"status": "ok"}
    }
  ]
}