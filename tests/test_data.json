[
  {
    "name": "hello",
    "command": { "command": "system.hello", "data": { "client": "tw-tests", "version": "0.1" } },
    "expect": { "status": "ok", "type": "session.hello" }
  },
  {
    "name": "capabilities",
    "command": { "command": "system.capabilities" },
    "expect": { "status": "ok", "type": "system.capabilities" }
  },
  {
    "name": "register user",
    "command": { "command": "auth.register", "data": { "user_name": "Test196", "password": "secret" } },
    "expect": { "status": "ok", "type": "auth.session" }
  },
  {
    "name": "prefs: bad key (invalid characters)",
    "command": { "command": "player.set_prefs", "data": { "patch": { "bad key": true } } },
    "expect": { "status": "error", "code": 1302 }
  },
  {
    "name": "prefs: ok (locale + theme)",
    "command": { "command": "player.set_prefs", "data": { "patch": { "ui.locale": "en-GB", "ui.theme": "dark" } } },
    "expect": { "status": "ok", "type": "player.prefs.updated" }
  },
  {
    "name": "bookmark: invalid name (too long)",
    "command": { "command": "nav.bookmark.add", "data": { "name": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA", "sector_id": 1 } },
    "expect": { "status": "error", "code": 1302 }
  },
  {
    "name": "bookmark: missing sector_id",
    "command": { "command": "nav.bookmark.add", "data": { "name": "Home" } },
    "expect": { "status": "error", "code": 1301 }
  },
  {
    "name": "bookmark: ok",
    "command": { "command": "nav.bookmark.add", "data": { "name": "Home", "sector_id": 1 } },
    "expect": { "status": "ok", "type": "nav.bookmark.added" }
  },
  {
    "name": "bookmark: list",
    "command": { "command": "nav.bookmark.list" },
    "expect": { "status": "ok", "type": "nav.bookmark.list" }
  },
  {
    "name": "avoid: add ok",
    "command": { "command": "nav.avoid.add", "data": { "sector_id": 2 } },
    "expect": { "status": "ok", "type": "nav.avoid.added" }
  },
  {
    "name": "avoid: duplicate sector â†’ duplicate request",
    "command": { "command": "nav.avoid.add", "data": { "sector_id": 2 } },
    "expect": { "status": "error", "code": 1105 }
  },
  {
    "name": "avoid: remove ok",
    "command": { "command": "nav.avoid.remove", "data": { "sector_id": 2 } },
    "expect": { "status": "ok", "type": "nav.avoid.removed" }
  },
  {
    "name": "subscribe: missing event_type",
    "command": { "command": "subscribe.add", "data": { } },
    "expect": { "status": "error", "code": 1301 }
  },
  {
    "name": "subscribe: invalid event_type",
    "command": { "command": "subscribe.add", "data": { "event_type": "nonsense.topic" } },
    "expect": { "status": "error", "code": 1302 }
  },
  {
    "name": "subscribe: ok system.notice",
    "command": { "command": "subscribe.add", "data": { "event_type": "system.notice" } },
    "expect": { "status": "ok", "type": "subscribe.added" }
  },
  {
    "name": "subscribe: ok sector.*",
    "command": { "command": "subscribe.add", "data": { "event_type": "sector.*" } },
    "expect": { "status": "ok", "type": "subscribe.added" }
  },
  {
    "name": "subscribe: list",
    "command": { "command": "subscribe.list" },
    "expect": { "status": "ok", "type": "subscribe.list" }
  }
]
