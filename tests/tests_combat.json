{
  "meta": { "generated_at": "2025-11-03T12:55:00Z", "purpose": "Combat + scan (stable ops only)" },
  "tests": [
    { "name": "auth.login",
      "command": { "command": "auth.login", "data": { "user_name": "newguy", "password": "pass123" } },
      "expect": { "status": "ok" }
    },

    { "name": "sector.info (capture @curSector for commands only)",
      "command": { "command": "sector.info" },
      "expect": { "status": "ok", "type": "*" },
      "save": { "@curSector": "data.sector_id" },
      "asserts": [
        { "path": "data.sector_id", "op": ">=", "value": 1 }
      ]
    },

    { "name": "sector.scan — current",
      "command": { "command": "sector.scan" },
      "expect": { "status": "ok", "type": "*" },
      "asserts": [
        { "path": "data.sector_id", "op": ">=", "value": 1 }
      ]
    },

    { "name": "sector.scan — explicit @curSector (no assert equality)",
      "command": { "command": "sector.scan", "data": { "sector_id": "${curSector}" } },
      "expect": { "status": "ok", "type": "*" }
    },

    { "name": "sector.scan — explicit 1",
      "command": { "command": "sector.scan", "data": { "sector_id": 1 } },
      "expect": { "status": "ok", "type": "*" }
    },

    { "name": "combat.deploy_fighters — ok (amount=1, DEFEND, no corp)",
      "command": { "command": "combat.deploy_fighters", "data": { "amount": 1, "offense": 2, "corporation_id": null } },
      "expect": { "status": "ok", "type": "combat.fighters.deployed" }
    },

    { "name": "combat.deploy_fighters — insufficient (expect 1503)",
      "command": { "command": "combat.deploy_fighters", "data": { "amount": 999999, "offense": 2, "corporation_id": null } },
      "expect": { "status": "refused", "type": "error", "error": { "code": 1503 } }
    },

    { "name": "deploy.fighters.list — current sector",
      "command": { "command": "deploy.fighters.list" },
      "expect": { "status": "ok", "type": "*" }
    },

    { "name": "deploy.fighters.list — sector 1",
      "command": { "command": "deploy.fighters.list", "data": { "sector_id": 1 } },
      "expect": { "status": "ok", "type": "*" }
    },

    { "name": "deploy.fighters.list — pagination (limit 5)",
      "command": { "command": "deploy.fighters.list", "data": { "limit": 5, "offset": 0 } },
      "expect": { "status": "ok", "type": "*" }
    },

    { "name": "deploy.mines.list — current sector",
      "command": { "command": "deploy.mines.list" },
      "expect": { "status": "ok", "type": "*" }
    },

    { "name": "deploy.mines.list — armid only",
      "command": { "command": "deploy.mines.list", "data": { "mine_type": "armid" } },
      "expect": { "status": "ok", "type": "*" }
    },

    { "name": "deploy.mines.list — limpet only",
      "command": { "command": "deploy.mines.list", "data": { "mine_type": "limpet" } },
      "expect": { "status": "ok", "type": "*" }
    },

    { "name": "deploy.mines.list — invalid type (1306)",
      "command": { "command": "deploy.mines.list", "data": { "mine_type": "banana" } },
      "expect": { "status": "error", "type": "error", "error": { "code": 1306 } }
    }
  ]
}
