--- server_cron.c
+++ server_cron.c
@@ -1421,6 +1421,13 @@
             if (trade_qty > 0)
               {
                 int trade_price = sell->price;
+                db_error_t err;
+                if (!db_tx_begin(db, DB_TX_IMMEDIATE, &err))
+                  {
+                    LOGE("h_daily_market_settlement: Failed to start transaction: %s", err.message);
+                    break;
+                  }
+                bool trade_ok = true;
                 long long total_cost = (long long) trade_qty * trade_price;
 
                 // Execute Trade
@@ -1443,11 +1450,11 @@
                                            buyer_acct,
                                            total_cost,
                                            "TRADE_BUY",
-                                           "MARKET_SETTLEMENT", &new_bal);
-                h_add_credits_unlocked (db,
+                                           "MARKET_SETTLEMENT", &new_bal) != 0) trade_ok = false;
+                if (trade_ok && h_add_credits_unlocked (db,
                                         seller_acct,
                                         total_cost,
                                         "TRADE_SELL",
-                                        "MARKET_SETTLEMENT", &new_bal);
+                                        "MARKET_SETTLEMENT", &new_bal) != 0) trade_ok = false;
 
-                if (strcmp (sell->actor_type, "port") == 0)
+                if (trade_ok && strcmp (sell->actor_type, "port") == 0)
