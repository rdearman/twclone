[
    {
	"name": "Unauthenticated: Player Info (Refused)",
	"command": { "command": "player.my_info" },
	"expect": { "status": "refused", "code": 1401 }
    },
    {
	"name": "Login (Valid)",
	"command": {
	    "command": "auth.login",
	    "data": { "user_name": "thor", "password": "hammer" }
	},
	"expect": { "status": "ok", "type": "auth.session" }
    },
    {
	"name": "RateLimit: ping #1",
	"command": { "command": "system.hello" },
	"expect": { "status": "ok", "type": "system.capabilities" }
    },
    {
	"name": "RateLimit: ping #2",
	"command": { "command": "system.hello" },
	"expect": { "status": "ok", "type": "system.capabilities" }
    },
    {
	"name": "RateLimit: ping #3",
	"command": { "command": "system.hello" },
	"expect": { "status": "ok", "type": "system.capabilities" }
    },

    {
	"name": "Describe Sector includes adjacency",
	"command": { "command": "move.describe_sector", "data": { "sector_id": 25 } },
	"expect": { "status": "ok", "type": "sector.info" }
    },

    {
	"name": "Login (Invalid Credentials)",
	"command": {
	    "command": "auth.login",
	    "data": { "user_name": "loki", "password": "lie" }
	},
	"expect": { "status": "error", "code": 1220 }
    },
    {
	"name": "Schema Guard (Missing Command)",
	"command": { "data": { "user_name": "thor" } },
	"expect": { "status": "error", "code": 1300 }
    },
    {
	"name": "System: Capabilities",
	"command": { "command": "system.hello" },
	"expect": { "status": "ok", "type": "system.capabilities" }
    },
    {
	"name": "Schema: List",
	"command": { "command": "system.describe_schema" },
	"expect": { "status": "ok", "type": "system.schema_list" }
    },
    {
	"name": "Schema: Get auth.login",
	"command": { "command": "system.describe_schema", "data": { "key": "auth.login" } },
	"expect": { "status": "ok", "type": "system.schema" }
    },
    {
	"name": "Get Player Info",
	"command": { "command": "player.my_info" },
	"expect": { "status": "ok", "type": "player.info" }
    },
    {
	"name": "Ship Info",
	"command": { "command": "ship.info" },
	"expect": { "status": "ok", "type": "ship.info" }
    },
    {
	"name": "List Online Players",
	"command": { "command": "player.list_online" },
	"expect": { "status": "ok", "type": "player.list_online" }
    },
    {
	"name": "Describe Current Sector",
	"command": { "command": "move.describe_sector" },
	"expect": { "status": "ok", "type": "sector.info" }
    },
    {
	"name": "Trade: Buy Ore",
	"command": {
	    "command": "trade.buy",
	    "data": { "port_id": 7, "commodity": "ore", "quantity": 10 },
	    "meta": { "idempotency_key": "buy-ore-1" }
	},
	"expect": { "status": "ok" }
    },
    {
	"name": "Movement: Warp",
	"command": { "command": "move.warp", "data": { "to_sector_id": 43 } },
	"expect": { "status": "ok", "type": "move.result" }
    },
    {
	"name": "Movement: Warp (Refused - No Link)",
	"command": { "command": "move.warp", "data": { "to_sector_id": 9999 } },
	"expect": { "status": "refused", "code": 1402 }
    },
    {
	"name": "Refused: Trade not enough credits",
	"command": {
	    "command": "trade.buy",
	    "data": { "port_id": 7, "commodity": "ore", "quantity": 999999 }
	},
	"expect": { "status": "refused", "code": 1410 }
    },
    {
	"name": "Refused: Trade not enough holds",
	"command": {
	    "command": "trade.buy",
	    "data": { "port_id": 7, "commodity": "ore", "quantity": 100 }
	},
	"expect": { "status": "refused", "code": 1411 }
    },
    {
	"name": "Idempotency: trade.buy first-run (key1)",
	"command": {
	    "command": "trade.buy",
	    "data": { "port_id": 7, "commodity": "ore", "quantity": 10 },
	    "meta": { "idempotency_key": "buy-ore-repeat-1" }
	},
	"expect": { "status": "ok", "type": "trade.accepted" }
    },
    {
	"name": "Idempotency: trade.buy replay same key+payload (key1)",
	"command": {
	    "command": "trade.buy",
	    "data": { "port_id": 7, "commodity": "ore", "quantity": 10 },
	    "meta": { "idempotency_key": "buy-ore-repeat-1" }
	},
	"expect": { "status": "ok", "type": "trade.accepted" }
    },
    {
	"name": "Idempotency: key reused with different payload (key1)",
	"command": {
	    "command": "trade.buy",
	    "data": { "port_id": 7, "commodity": "ore", "quantity": 20 },
	    "meta": { "idempotency_key": "buy-ore-repeat-1" }
	},
	"expect": { "status": "error", "code": 1105 }
    },
    {
	"name": "Idempotency: trade.buy first-run (key2)",
	"command": {
	    "command": "trade.buy",
	    "data": { "port_id": 7, "commodity": "ore", "quantity": 10 },
	    "meta": { "idempotency_key": "buy-ore-repeat-2" }
	},
	"expect": { "status": "ok", "type": "trade.accepted" }
    },
    {
	"name": "Idempotency: trade.buy replay same key+payload (key2)",
	"command": {
	    "command": "trade.buy",
	    "data": { "port_id": 7, "commodity": "ore", "quantity": 10 },
	    "meta": { "idempotency_key": "buy-ore-repeat-2" }
	},
	"expect": { "status": "ok", "type": "trade.accepted" }
    },
    {
	"name": "Idempotency: key reused with different payload (key2)",
	"command": {
	    "command": "trade.buy",
	    "data": { "port_id": 7, "commodity": "ore", "quantity": 20 },
	    "meta": { "idempotency_key": "buy-ore-repeat-2" }
	},
	"expect": { "status": "error", "code": 1105 }
    },
    {
	"name": "Auth: Register New",
	"command": { "command": "auth.register", "data": { "user_name": "newguy", "password": "pass123" } },
	"expect": { "status": "ok", "type": "auth.session" }
    },
    {
	"name": "Auth: Refresh",
	"command": { "command": "auth.refresh" },
	"expect": { "status": "ok", "type": "auth.session" }
    },
    {
	"name": "Auth: Logout",
	"command": { "command": "auth.logout" },
	"expect": { "status": "ok", "type": "auth.logged_out" }
    },
    {
	"name": "System: Disconnect",
	"command": { "command": "system.disconnect" },
	"expect": { "status": "ok", "type": "system.goodbye" }
    }
]
